:root { --ink:#111827; --muted:#6b7280; --line:#e5e7eb; --brand:#6366f1; }
* { box-sizing: border-box; }
body { margin:0; font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif; color:var(--ink); background:#f3f4f6; }
a { color:inherit; text-decoration:none; }

.bar { position:sticky; top:0; z-index:10; background:#fff; border:1px solid var(--line); padding:10px 14px; display:flex; align-items:center; justify-content:space-between; border-radius:12px; margin:16px auto; max-width:980px; }
.brand { display:flex; align-items:center; gap:10px; }
.brand img { width:20px; height:20px; }
.brand span { font-weight:800; letter-spacing:.2px; }
.history { color:var(--muted); }
.btn { border:1px solid var(--line); background:#fff; padding:8px 10px; border-radius:8px; cursor:pointer; font-weight:600; }
.btn.primary { background:linear-gradient(135deg,#6366f1,#8b5cf6); color:#fff; border:none; }
.muted { color:var(--muted); }
.center { text-align:center; }
.mt-16 { margin-top:16px; }

.card { background:#fff; border:1px solid var(--line); border-radius:12px; padding:20px; box-shadow:0 10px 25px rgba(0,0,0,.05); }
.clickable { cursor:pointer; }
.dropzone { transition:border-color 150ms ease; }
.dropzone:hover { border-color:#a5b4fc; }

/* Enhanced Factsheet Styling for Beautiful Display */
.sheet-shadow {
  background: linear-gradient(145deg, #ffffff, #f8fafc);
  border: 2px solid #e2e8f0;
  box-shadow: 0 25px 60px rgba(0,0,0,.12), 0 0 0 1px rgba(255,255,255,.05);
  padding:15px;
  border-radius:16px;
  position:relative;
  overflow:hidden;
}
.sheet-shadow::before {
  content:'';
  position:absolute;
  top:0; left:0; right:0; height:4px;
  background:linear-gradient(90deg, #6366f1, #8b5cf6, #ec4899);
}
#sheet {
  width:210mm; height:297mm; background:#fff; margin:0 auto; color:var(--ink);
  display:grid; grid-template-rows:auto 1fr auto; row-gap:8px;
  font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  line-height:1.3;
  position:relative;
}
.s-header {
  display:flex; justify-content:space-between; align-items:flex-start;
  padding:12px 16px 0 16px; background:linear-gradient(135deg, #f8fafc, #e2e8f0);
  border-radius:8px 8px 0 0;
}
.s-brand {
  display:flex; align-items:center; gap:8px;
  background:linear-gradient(135deg, #6366f1, #8b5cf6);
  color:#fff; padding:6px 10px; border-radius:50px;
}
.s-brand img { width:20px; height:20px; filter:brightness(0) invert(1); }
.s-brand .name { font-weight:900; font-size:16px; letter-spacing:.3px; }
.s-date { color:#64748b; font-size:12px; font-weight:500; }
.s-body {
  display:grid; grid-template-columns:1.05fr .95fr; column-gap:10px;
  align-items:start; padding:0 14px; gap:10px;
}
.right {
  display:grid; grid-template-rows:auto auto auto auto; gap:10px;
}
.kpi {
  display:grid; grid-template-columns:1fr 1fr; gap:8px;
  background:linear-gradient(135deg, #f1f5f9, #e2e8f0); padding:12px; border-radius:10px;
}
.kpi .box {
  background:#fff; border:1px solid #cbd5e1; border-radius:8px; padding:8px;
  text-align:center; box-shadow:0 2px 8px rgba(0,0,0,.03);
  transition:transform 150ms ease;
}
.kpi .box:hover { transform:translateY(-1px); }
.kpi .val {
  font-weight:900; font-size:16px; color:#1e293b;
  background:linear-gradient(135deg, #6366f1, #8b5cf6); -webkit-background-clip:text; -webkit-text-fill-color:transparent;
}
.kpi .lbl { font-size:10px; color:#64748b; font-weight:600; }
.grid2 { display:grid; grid-template-columns:1fr 1fr; gap:8px; }
.kv {
  display:flex; justify-content:space-between; background:#f8fafc;
  border:1px solid #e2e8f0; border-radius:8px; padding:6px 8px;
  font-size:10px; transition:background 150ms ease;
}
.kv:hover { background:#f1f5f9; }
.kv .val { font-weight:800; color:#1e293b; }
.ul {
  margin:0; padding-left:16px; font-size:10px; columns:2; column-gap:16px;
  color:#374151; line-height:1.5;
}
.team {
  display:grid; grid-template-columns:repeat(5,1fr); gap:6px;
  background:linear-gradient(135deg, #fefce8, #fef3c7); padding:12px; border-radius:10px;
}
.member {
  display:flex; align-items:center; gap:6px; background:#fff;
  border:1px solid #e5e7eb; border-radius:8px; padding:6px;
  box-shadow:0 2px 8px rgba(0,0,0,.03); transition:transform 150ms ease;
}
.member:hover { transform:translateY(-1px); box-shadow:0 4px 12px rgba(0,0,0,.06); }
.member img {
  width:36px; height:36px; border-radius:50%; border:1px solid #cbd5e1;
  object-fit:cover; box-shadow:0 1px 4px rgba(0,0,0,.08);
}
.member .n { font-size:11px; font-weight:800; line-height:1.1; color:#1e293b; }
.member .t { font-size:9px; color:#64748b; line-height:1.1; font-weight:600; }
.member .b { font-size:8px; color:#64748b; line-height:1.2; }
.calendar {
  background:linear-gradient(135deg, #f0f9ff, #e0f2fe); padding:12px; border-radius:10px;
}
.calendar table {
  width:100%; border-collapse:collapse; font-size:10px;
  background:#fff; border-radius:6px; overflow:hidden;
}
.calendar th, .calendar td {
  padding:4px 6px; border-bottom:1px solid #e2e8f0; text-align:center;
  font-weight:600;
}
.calendar th:first-child, .calendar td:first-child { text-align:left; }
.calendar .ytd { font-weight:900; color:#1e293b; background:#f1f5f9; }
.s-footer {
  padding:0 16px 12px 16px; text-align:center; font-size:9px;
  color:#64748b; background:linear-gradient(135deg, #f8fafc, #e2e8f0);
  border-radius:0 0 8px 8px;
}

@media screen {
  .wrap {
    max-height: 90vh;
    overflow-y: auto;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
  }
  #sheet {
    height: auto !important;
  }
}

@media print {
  /* Use CSS zoom to hard-scale everything to fit page exactly */
  @page { size:A4; margin:0; }
  html, body { height:100%; }
  body * { visibility:hidden !important; }
  #sheet { visibility:visible !important; transform-origin: top left; margin:0 auto !important; width:210mm !important; }
  #sheet * { visibility:visible !important; }
  #pdfActions { display:none !important; }
}

